import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/layout/ClientSelector.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=2c4c02a3"; const Fragment = __vite__cjsImport0_react_jsxDevRuntime["Fragment"]; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=2c4c02a3"; const useState = __vite__cjsImport3_react["useState"]; const useEffect = __vite__cjsImport3_react["useEffect"];
import { Building2, ChevronDown, Check, X } from "/node_modules/.vite/deps/lucide-react.js?v=2c4c02a3";
import { useClient } from "/src/context/ClientContext.tsx";
export function ClientSelector() {
  _s();
  const { activeClient, setActiveClient, clearActiveClient } = useClient();
  const [clients, setClients] = useState([]);
  const [isOpen, setIsOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  useEffect(() => {
    loadClients();
  }, []);
  const loadClients = async () => {
    setLoading(true);
    try {
      const data = await window.api.listClients();
      console.log("Loaded clients:", data);
      setClients(data || []);
    } catch (error) {
      console.error("Failed to load clients:", error);
    } finally {
      setLoading(false);
    }
  };
  const handleToggleDropdown = () => {
    if (!isOpen) {
      loadClients();
    }
    setIsOpen(!isOpen);
  };
  const handleSelectClient = (client) => {
    setActiveClient({ id: client.id, name: client.name });
    setIsOpen(false);
  };
  const handleClearClient = (e) => {
    e.stopPropagation();
    clearActiveClient();
    setIsOpen(false);
  };
  return /* @__PURE__ */ jsxDEV("div", { className: "relative", children: [
    /* @__PURE__ */ jsxDEV(
      "button",
      {
        onClick: handleToggleDropdown,
        className: `flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${activeClient ? "bg-blue-600 text-white hover:bg-blue-700" : "bg-gray-700 text-gray-300 hover:bg-gray-600"}`,
        children: [
          /* @__PURE__ */ jsxDEV(Building2, { size: 18 }, void 0, false, {
            fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
            lineNumber: 82,
            columnNumber: 9
          }, this),
          /* @__PURE__ */ jsxDEV("span", { className: "text-sm font-medium", children: activeClient ? activeClient.name : "All Clients" }, void 0, false, {
            fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
            lineNumber: 83,
            columnNumber: 9
          }, this),
          activeClient && /* @__PURE__ */ jsxDEV(
            "button",
            {
              onClick: handleClearClient,
              className: "ml-1 p-0.5 hover:bg-blue-500 rounded",
              title: "Clear selection",
              children: /* @__PURE__ */ jsxDEV(X, { size: 14 }, void 0, false, {
                fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                lineNumber: 92,
                columnNumber: 13
              }, this)
            },
            void 0,
            false,
            {
              fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
              lineNumber: 87,
              columnNumber: 9
            },
            this
          ),
          /* @__PURE__ */ jsxDEV(ChevronDown, { size: 16 }, void 0, false, {
            fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
            lineNumber: 95,
            columnNumber: 9
          }, this)
        ]
      },
      void 0,
      true,
      {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
        lineNumber: 74,
        columnNumber: 7
      },
      this
    ),
    isOpen && /* @__PURE__ */ jsxDEV(Fragment, { children: [
      /* @__PURE__ */ jsxDEV(
        "div",
        {
          className: "fixed inset-0 z-30",
          onClick: () => setIsOpen(false)
        },
        void 0,
        false,
        {
          fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
          lineNumber: 101,
          columnNumber: 11
        },
        this
      ),
      /* @__PURE__ */ jsxDEV("div", { className: "absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-40 max-h-96 overflow-y-auto", children: /* @__PURE__ */ jsxDEV("div", { className: "p-2", children: [
        /* @__PURE__ */ jsxDEV("div", { className: "px-3 py-2 text-xs font-semibold text-gray-500 uppercase", children: "Select Active Client" }, void 0, false, {
          fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
          lineNumber: 109,
          columnNumber: 15
        }, this),
        /* @__PURE__ */ jsxDEV(
          "button",
          {
            onClick: handleClearClient,
            className: "w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors flex items-center justify-between",
            children: [
              /* @__PURE__ */ jsxDEV("span", { className: "text-sm text-gray-700", children: "All Clients (No Filter)" }, void 0, false, {
                fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                lineNumber: 118,
                columnNumber: 17
              }, this),
              !activeClient && /* @__PURE__ */ jsxDEV(Check, { size: 16, className: "text-blue-600" }, void 0, false, {
                fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                lineNumber: 120,
                columnNumber: 15
              }, this)
            ]
          },
          void 0,
          true,
          {
            fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
            lineNumber: 114,
            columnNumber: 15
          },
          this
        ),
        /* @__PURE__ */ jsxDEV("div", { className: "border-t border-gray-200 my-2" }, void 0, false, {
          fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
          lineNumber: 124,
          columnNumber: 15
        }, this),
        loading ? /* @__PURE__ */ jsxDEV("div", { className: "px-3 py-4 text-sm text-gray-500 text-center", children: "Loading clients..." }, void 0, false, {
          fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
          lineNumber: 127,
          columnNumber: 13
        }, this) : clients.length === 0 ? /* @__PURE__ */ jsxDEV("div", { className: "px-3 py-4 text-sm text-gray-500 text-center", children: "No clients available" }, void 0, false, {
          fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
          lineNumber: 131,
          columnNumber: 13
        }, this) : clients.map(
          (client) => /* @__PURE__ */ jsxDEV(
            "button",
            {
              onClick: () => handleSelectClient(client),
              className: "w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors flex items-center justify-between",
              children: [
                /* @__PURE__ */ jsxDEV("div", { children: [
                  /* @__PURE__ */ jsxDEV("div", { className: "text-sm font-medium text-gray-900", children: client.name }, void 0, false, {
                    fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                    lineNumber: 142,
                    columnNumber: 23
                  }, this),
                  /* @__PURE__ */ jsxDEV("div", { className: "text-xs text-gray-500", children: [
                    "Added ",
                    new Date(client.createdAt).toLocaleDateString()
                  ] }, void 0, true, {
                    fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                    lineNumber: 145,
                    columnNumber: 23
                  }, this)
                ] }, void 0, true, {
                  fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                  lineNumber: 141,
                  columnNumber: 21
                }, this),
                activeClient?.id === client.id && /* @__PURE__ */ jsxDEV(Check, { size: 16, className: "text-blue-600" }, void 0, false, {
                  fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
                  lineNumber: 150,
                  columnNumber: 15
                }, this)
              ]
            },
            client.id,
            true,
            {
              fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
              lineNumber: 136,
              columnNumber: 13
            },
            this
          )
        )
      ] }, void 0, true, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
        lineNumber: 108,
        columnNumber: 13
      }, this) }, void 0, false, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
        lineNumber: 107,
        columnNumber: 11
      }, this)
    ] }, void 0, true, {
      fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
      lineNumber: 99,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx",
    lineNumber: 73,
    columnNumber: 5
  }, this);
}
_s(ClientSelector, "n28h8ZS0GF8HOY/ctHi/VewdhGY=", false, function() {
  return [useClient];
});
_c = ClientSelector;
var _c;
$RefreshReg$(_c, "ClientSelector");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Users/Bill.S/safety-intelligence-engine/src/components/layout/ClientSelector.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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LHVCQUFDLFNBQU0sTUFBTSxJQUFJLFdBQVUsbUJBQTNCO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQTBDO0FBQUE7QUFBQTtBQUFBLFlBYnZDRCxPQUFPQztBQUFBQSxZQURkO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsVUFnQkE7QUFBQSxRQUNEO0FBQUEsV0E3Q0w7QUFBQTtBQUFBO0FBQUE7QUFBQSxhQStDQSxLQWhERjtBQUFBO0FBQUE7QUFBQTtBQUFBLGFBaURBO0FBQUEsU0F6REY7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQTBEQTtBQUFBLE9BcEZKO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FzRkE7QUFFSjtBQUFDckIsR0FuSWVELGdCQUFjO0FBQUEsVUFDaUNELFNBQVM7QUFBQTtBQUFBaUMsS0FEeERoQztBQUFjLElBQUFnQztBQUFBQyxhQUFBRCxJQUFBIiwibmFtZXMiOlsidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJCdWlsZGluZzIiLCJDaGV2cm9uRG93biIsIkNoZWNrIiwiWCIsInVzZUNsaWVudCIsIkNsaWVudFNlbGVjdG9yIiwiX3MiLCJhY3RpdmVDbGllbnQiLCJzZXRBY3RpdmVDbGllbnQiLCJjbGVhckFjdGl2ZUNsaWVudCIsImNsaWVudHMiLCJzZXRDbGllbnRzIiwiaXNPcGVuIiwic2V0SXNPcGVuIiwibG9hZGluZyIsInNldExvYWRpbmciLCJsb2FkQ2xpZW50cyIsImRhdGEiLCJ3aW5kb3ciLCJhcGkiLCJsaXN0Q2xpZW50cyIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsImhhbmRsZVRvZ2dsZURyb3Bkb3duIiwiaGFuZGxlU2VsZWN0Q2xpZW50IiwiY2xpZW50IiwiaWQiLCJuYW1lIiwiaGFuZGxlQ2xlYXJDbGllbnQiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwibGVuZ3RoIiwibWFwIiwiRGF0ZSIsImNyZWF0ZWRBdCIsInRvTG9jYWxlRGF0ZVN0cmluZyIsIl9jIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIkNsaWVudFNlbGVjdG9yLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEJ1aWxkaW5nMiwgQ2hldnJvbkRvd24sIENoZWNrLCBYIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcbmltcG9ydCB7IHVzZUNsaWVudCB9IGZyb20gJ0AvY29udGV4dC9DbGllbnRDb250ZXh0JztcblxuaW50ZXJmYWNlIENsaWVudCB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBEYXRlIHwgc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gQ2xpZW50U2VsZWN0b3IoKSB7XG4gIGNvbnN0IHsgYWN0aXZlQ2xpZW50LCBzZXRBY3RpdmVDbGllbnQsIGNsZWFyQWN0aXZlQ2xpZW50IH0gPSB1c2VDbGllbnQoKTtcbiAgY29uc3QgW2NsaWVudHMsIHNldENsaWVudHNdID0gdXNlU3RhdGU8Q2xpZW50W10+KFtdKTtcbiAgY29uc3QgW2lzT3Blbiwgc2V0SXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbG9hZENsaWVudHMoKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IGxvYWRDbGllbnRzID0gYXN5bmMgKCkgPT4ge1xuICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB3aW5kb3cuYXBpLmxpc3RDbGllbnRzKCk7XG4gICAgICBjb25zb2xlLmxvZygnTG9hZGVkIGNsaWVudHM6JywgZGF0YSk7IC8vIERlYnVnIGxvZ1xuICAgICAgc2V0Q2xpZW50cyhkYXRhIHx8IFtdKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgY2xpZW50czonLCBlcnJvcik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICAvLyBSZWZyZXNoIGNsaWVudHMgbGlzdCB3aGVuIGRyb3Bkb3duIG9wZW5zXG4gIGNvbnN0IGhhbmRsZVRvZ2dsZURyb3Bkb3duID0gKCkgPT4ge1xuICAgIGlmICghaXNPcGVuKSB7XG4gICAgICBsb2FkQ2xpZW50cygpOyAvLyBSZWZyZXNoIHRoZSBsaXN0IHdoZW4gb3BlbmluZ1xuICAgIH1cbiAgICBzZXRJc09wZW4oIWlzT3Blbik7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlU2VsZWN0Q2xpZW50ID0gKGNsaWVudDogQ2xpZW50KSA9PiB7XG4gICAgc2V0QWN0aXZlQ2xpZW50KHsgaWQ6IGNsaWVudC5pZCwgbmFtZTogY2xpZW50Lm5hbWUgfSk7XG4gICAgc2V0SXNPcGVuKGZhbHNlKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVDbGVhckNsaWVudCA9IChlOiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBjbGVhckFjdGl2ZUNsaWVudCgpO1xuICAgIHNldElzT3BlbihmYWxzZSk7XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlXCI+XG4gICAgICA8YnV0dG9uXG4gICAgICAgIG9uQ2xpY2s9e2hhbmRsZVRvZ2dsZURyb3Bkb3dufVxuICAgICAgICBjbGFzc05hbWU9e2BmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTIgcHgtNCBweS0yIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1jb2xvcnMgJHtcbiAgICAgICAgICBhY3RpdmVDbGllbnRcbiAgICAgICAgICAgID8gJ2JnLWJsdWUtNjAwIHRleHQtd2hpdGUgaG92ZXI6YmctYmx1ZS03MDAnXG4gICAgICAgICAgICA6ICdiZy1ncmF5LTcwMCB0ZXh0LWdyYXktMzAwIGhvdmVyOmJnLWdyYXktNjAwJ1xuICAgICAgICB9YH1cbiAgICAgID5cbiAgICAgICAgPEJ1aWxkaW5nMiBzaXplPXsxOH0gLz5cbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPlxuICAgICAgICAgIHthY3RpdmVDbGllbnQgPyBhY3RpdmVDbGllbnQubmFtZSA6ICdBbGwgQ2xpZW50cyd9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAge2FjdGl2ZUNsaWVudCAmJiAoXG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ2xlYXJDbGllbnR9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJtbC0xIHAtMC41IGhvdmVyOmJnLWJsdWUtNTAwIHJvdW5kZWRcIlxuICAgICAgICAgICAgdGl0bGU9XCJDbGVhciBzZWxlY3Rpb25cIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxYIHNpemU9ezE0fSAvPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICApfVxuICAgICAgICA8Q2hldnJvbkRvd24gc2l6ZT17MTZ9IC8+XG4gICAgICA8L2J1dHRvbj5cblxuICAgICAge2lzT3BlbiAmJiAoXG4gICAgICAgIDw+XG4gICAgICAgICAgey8qIEJhY2tkcm9wICovfVxuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgei0zMFwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRJc09wZW4oZmFsc2UpfVxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICB7LyogRHJvcGRvd24gKi99XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSB0b3AtZnVsbCBsZWZ0LTAgbXQtMiB3LTY0IGJnLXdoaXRlIHJvdW5kZWQtbGcgc2hhZG93LWxnIGJvcmRlciBib3JkZXItZ3JheS0yMDAgei00MCBtYXgtaC05NiBvdmVyZmxvdy15LWF1dG9cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC0yXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHgtMyBweS0yIHRleHQteHMgZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktNTAwIHVwcGVyY2FzZVwiPlxuICAgICAgICAgICAgICAgIFNlbGVjdCBBY3RpdmUgQ2xpZW50XG4gICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgIHsvKiBDbGVhciBTZWxlY3Rpb24gT3B0aW9uICovfVxuICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ2xlYXJDbGllbnR9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIHRleHQtbGVmdCBweC0zIHB5LTIgcm91bmRlZCBob3ZlcjpiZy1ncmF5LTEwMCB0cmFuc2l0aW9uLWNvbG9ycyBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNzAwXCI+QWxsIENsaWVudHMgKE5vIEZpbHRlcik8L3NwYW4+XG4gICAgICAgICAgICAgICAgeyFhY3RpdmVDbGllbnQgJiYgKFxuICAgICAgICAgICAgICAgICAgPENoZWNrIHNpemU9ezE2fSBjbGFzc05hbWU9XCJ0ZXh0LWJsdWUtNjAwXCIgLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJvcmRlci10IGJvcmRlci1ncmF5LTIwMCBteS0yXCIgLz5cblxuICAgICAgICAgICAgICB7bG9hZGluZyA/IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB4LTMgcHktNCB0ZXh0LXNtIHRleHQtZ3JheS01MDAgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgIExvYWRpbmcgY2xpZW50cy4uLlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApIDogY2xpZW50cy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJweC0zIHB5LTQgdGV4dC1zbSB0ZXh0LWdyYXktNTAwIHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICBObyBjbGllbnRzIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIGNsaWVudHMubWFwKChjbGllbnQpID0+IChcbiAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAga2V5PXtjbGllbnQuaWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZVNlbGVjdENsaWVudChjbGllbnQpfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgdGV4dC1sZWZ0IHB4LTMgcHktMiByb3VuZGVkIGhvdmVyOmJnLWdyYXktMTAwIHRyYW5zaXRpb24tY29sb3JzIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS05MDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtjbGllbnQubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgQWRkZWQge25ldyBEYXRlKGNsaWVudC5jcmVhdGVkQXQpLnRvTG9jYWxlRGF0ZVN0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge2FjdGl2ZUNsaWVudD8uaWQgPT09IGNsaWVudC5pZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENoZWNrIHNpemU9ezE2fSBjbGFzc05hbWU9XCJ0ZXh0LWJsdWUtNjAwXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC8+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufVxuIl0sImZpbGUiOiJDOi9Vc2Vycy9CaWxsLlMvc2FmZXR5LWludGVsbGlnZW5jZS1lbmdpbmUvc3JjL2NvbXBvbmVudHMvbGF5b3V0L0NsaWVudFNlbGVjdG9yLnRzeCJ9
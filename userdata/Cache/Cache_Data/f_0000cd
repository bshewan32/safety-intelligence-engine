import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/pages/ClientRiskMatrix.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=fa9e1c00"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=fa9e1c00"; const useEffect = __vite__cjsImport3_react["useEffect"]; const useState = __vite__cjsImport3_react["useState"];
import {
  XCircle,
  RefreshCw
} from "/node_modules/.vite/deps/lucide-react.js?v=fa9e1c00";
import RiskMatrixHeader from "/src/components/risk-matrix/RiskMatrixHeader.tsx";
import RiskMatrixFilters from "/src/components/risk-matrix/RiskMatrixFilters.tsx";
import RiskMatrixTable from "/src/components/risk-matrix/RiskMatrixTable.tsx";
export default function ClientRiskMatrix({ clientId, onBack }) {
  _s();
  const id = clientId;
  const [riskMatrix, setRiskMatrix] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [searchTerm, setSearchTerm] = useState("");
  const [riskLevelFilter, setRiskLevelFilter] = useState("All");
  const [statusFilter, setStatusFilter] = useState("All");
  useEffect(() => {
    loadRiskMatrix();
  }, [id]);
  async function loadRiskMatrix() {
    try {
      setLoading(true);
      setError(null);
      const data = await window.api.getClientRiskMatrix(id);
      setRiskMatrix(data);
    } catch (err) {
      const message = err instanceof Error ? err.message : "Failed to load risk matrix";
      setError(message);
    } finally {
      setLoading(false);
    }
  }
  async function handleHazardUpdate(hazardId, updates) {
    try {
      await window.api.updateClientHazard(hazardId, updates);
      await loadRiskMatrix();
    } catch (err) {
      const message = err instanceof Error ? err.message : "Failed to update hazard";
      alert("Failed to update hazard: " + message);
    }
  }
  async function handleAddControl(hazardId, controlId, isCritical) {
    try {
      await window.api.addControlToHazard({
        clientHazardId: hazardId,
        clientControlId: controlId,
        isCriticalControl: isCritical
      });
      await loadRiskMatrix();
    } catch (err) {
      const message = err instanceof Error ? err.message : "Failed to add control";
      alert("Failed to add control: " + message);
    }
  }
  async function handleRemoveControl(mappingId) {
    if (!confirm("Remove this control from the hazard?")) return;
    try {
      await window.api.removeControlFromHazard(mappingId);
      await loadRiskMatrix();
    } catch (err) {
      const message = err instanceof Error ? err.message : "Failed to remove control";
      alert("Failed to remove control: " + message);
    }
  }
  const filteredHazards = riskMatrix?.hazards.filter((hazard) => {
    if (searchTerm) {
      const term = searchTerm.toLowerCase();
      if (!hazard.code.toLowerCase().includes(term) && !hazard.name.toLowerCase().includes(term) && !hazard.description.toLowerCase().includes(term)) {
        return false;
      }
    }
    if (riskLevelFilter !== "All" && hazard.adjustedRiskLevel !== riskLevelFilter) {
      return false;
    }
    if (statusFilter === "Complete" && hazard.controlCoverage.percentage < 100) {
      return false;
    }
    if (statusFilter === "Gaps" && hazard.controlCoverage.percentage >= 100) {
      return false;
    }
    if (statusFilter === "N/A" && !hazard.isNotApplicable) {
      return false;
    }
    return true;
  }) || [];
  if (loading) {
    return /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-center h-screen", children: /* @__PURE__ */ jsxDEV("div", { className: "text-center", children: [
      /* @__PURE__ */ jsxDEV(RefreshCw, { className: "w-8 h-8 animate-spin mx-auto mb-4 text-blue-500" }, void 0, false, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 149,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV("p", { className: "text-gray-600", children: "Loading risk matrix..." }, void 0, false, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 150,
        columnNumber: 11
      }, this)
    ] }, void 0, true, {
      fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
      lineNumber: 148,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
      lineNumber: 147,
      columnNumber: 7
    }, this);
  }
  if (error || !riskMatrix) {
    return /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-center h-screen", children: /* @__PURE__ */ jsxDEV("div", { className: "text-center", children: [
      /* @__PURE__ */ jsxDEV(XCircle, { className: "w-16 h-16 mx-auto mb-4 text-red-500" }, void 0, false, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 160,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV("h2", { className: "text-xl font-semibold mb-2", children: "Error Loading Risk Matrix" }, void 0, false, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 161,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV("p", { className: "text-gray-600 mb-4", children: error || "Risk matrix not found" }, void 0, false, {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 162,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(
        "button",
        {
          onClick: onBack,
          className: "px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",
          children: "Back to Clients"
        },
        void 0,
        false,
        {
          fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
          lineNumber: 163,
          columnNumber: 11
        },
        this
      )
    ] }, void 0, true, {
      fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
      lineNumber: 159,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
      lineNumber: 158,
      columnNumber: 7
    }, this);
  }
  return /* @__PURE__ */ jsxDEV("div", { className: "max-w-7xl mx-auto p-6", children: [
    /* @__PURE__ */ jsxDEV(
      RiskMatrixHeader,
      {
        client: riskMatrix.client,
        summary: riskMatrix.summary,
        onBack,
        onRefresh: loadRiskMatrix,
        onExport: () => alert("Export coming soon!")
      },
      void 0,
      false,
      {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 177,
        columnNumber: 7
      },
      this
    ),
    /* @__PURE__ */ jsxDEV(
      RiskMatrixFilters,
      {
        searchTerm,
        onSearchChange: setSearchTerm,
        riskLevelFilter,
        onRiskLevelChange: setRiskLevelFilter,
        statusFilter,
        onStatusChange: setStatusFilter
      },
      void 0,
      false,
      {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 186,
        columnNumber: 7
      },
      this
    ),
    /* @__PURE__ */ jsxDEV("div", { className: "mb-4 text-sm text-gray-600", children: [
      "Showing ",
      filteredHazards.length,
      " of ",
      riskMatrix.hazards.length,
      " hazards"
    ] }, void 0, true, {
      fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
      lineNumber: 196,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(
      RiskMatrixTable,
      {
        hazards: filteredHazards,
        onUpdateHazard: handleHazardUpdate,
        onAddControl: handleAddControl,
        onRemoveControl: handleRemoveControl,
        clientId: id
      },
      void 0,
      false,
      {
        fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
        lineNumber: 201,
        columnNumber: 7
      },
      this
    )
  ] }, void 0, true, {
    fileName: "C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx",
    lineNumber: 175,
    columnNumber: 5
  }, this);
}
_s(ClientRiskMatrix, "LYr/a+mozqmCuw8L/lyzWJiL+Ws=");
_c = ClientRiskMatrix;
var _c;
$RefreshReg$(_c, "ClientRiskMatrix");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Users/Bill.S/safety-intelligence-engine/src/pages/ClientRiskMatrix.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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QUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFLZ0I7QUFBQSxPQS9CbEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxTQWlDQTtBQUVKO0FBQUNELEdBcEt1Qkgsa0JBQWdCO0FBQUEwRCxLQUFoQjFEO0FBQWdCLElBQUEwRDtBQUFBQyxhQUFBRCxJQUFBIiwibmFtZXMiOlsidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJYQ2lyY2xlIiwiUmVmcmVzaEN3IiwiUmlza01hdHJpeEhlYWRlciIsIlJpc2tNYXRyaXhGaWx0ZXJzIiwiUmlza01hdHJpeFRhYmxlIiwiQ2xpZW50Umlza01hdHJpeCIsImNsaWVudElkIiwib25CYWNrIiwiX3MiLCJpZCIsInJpc2tNYXRyaXgiLCJzZXRSaXNrTWF0cml4IiwibG9hZGluZyIsInNldExvYWRpbmciLCJlcnJvciIsInNldEVycm9yIiwic2VhcmNoVGVybSIsInNldFNlYXJjaFRlcm0iLCJyaXNrTGV2ZWxGaWx0ZXIiLCJzZXRSaXNrTGV2ZWxGaWx0ZXIiLCJzdGF0dXNGaWx0ZXIiLCJzZXRTdGF0dXNGaWx0ZXIiLCJsb2FkUmlza01hdHJpeCIsImRhdGEiLCJ3aW5kb3ciLCJhcGkiLCJnZXRDbGllbnRSaXNrTWF0cml4IiwiZXJyIiwibWVzc2FnZSIsIkVycm9yIiwiaGFuZGxlSGF6YXJkVXBkYXRlIiwiaGF6YXJkSWQiLCJ1cGRhdGVzIiwidXBkYXRlQ2xpZW50SGF6YXJkIiwiYWxlcnQiLCJoYW5kbGVBZGRDb250cm9sIiwiY29udHJvbElkIiwiaXNDcml0aWNhbCIsImFkZENvbnRyb2xUb0hhemFyZCIsImNsaWVudEhhemFyZElkIiwiY2xpZW50Q29udHJvbElkIiwiaXNDcml0aWNhbENvbnRyb2wiLCJoYW5kbGVSZW1vdmVDb250cm9sIiwibWFwcGluZ0lkIiwiY29uZmlybSIsInJlbW92ZUNvbnRyb2xGcm9tSGF6YXJkIiwiZmlsdGVyZWRIYXphcmRzIiwiaGF6YXJkcyIsImZpbHRlciIsImhhemFyZCIsInRlcm0iLCJ0b0xvd2VyQ2FzZSIsImNvZGUiLCJpbmNsdWRlcyIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImFkanVzdGVkUmlza0xldmVsIiwiY29udHJvbENvdmVyYWdlIiwicGVyY2VudGFnZSIsImlzTm90QXBwbGljYWJsZSIsImNsaWVudCIsInN1bW1hcnkiLCJsZW5ndGgiLCJfYyIsIiRSZWZyZXNoUmVnJCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJDbGllbnRSaXNrTWF0cml4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcGFnZXMvQ2xpZW50Umlza01hdHJpeC50c3hcclxuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB0eXBlIHtcclxuICBSaXNrTWF0cml4LFxyXG4gIFJpc2tNYXRyaXhIYXphcmQsXHJcbiAgSGF6YXJkVXBkYXRlLFxyXG59IGZyb20gJy4uL3R5cGVzL3Jpc2stbWF0cml4JztcclxuaW1wb3J0IHtcclxuICBBbGVydFRyaWFuZ2xlLFxyXG4gIENoZWNrQ2lyY2xlLFxyXG4gIFhDaXJjbGUsXHJcbiAgQXJyb3dMZWZ0LFxyXG4gIERvd25sb2FkLFxyXG4gIFJlZnJlc2hDdyxcclxuICBGaWx0ZXIsXHJcbiAgU2VhcmNoXHJcbn0gZnJvbSAnbHVjaWRlLXJlYWN0JztcclxuaW1wb3J0IFJpc2tNYXRyaXhIZWFkZXIgZnJvbSAnLi4vY29tcG9uZW50cy9yaXNrLW1hdHJpeC9SaXNrTWF0cml4SGVhZGVyJztcclxuaW1wb3J0IFJpc2tNYXRyaXhGaWx0ZXJzIGZyb20gJy4uL2NvbXBvbmVudHMvcmlzay1tYXRyaXgvUmlza01hdHJpeEZpbHRlcnMnO1xyXG5pbXBvcnQgUmlza01hdHJpeFRhYmxlIGZyb20gJy4uL2NvbXBvbmVudHMvcmlzay1tYXRyaXgvUmlza01hdHJpeFRhYmxlJztcclxuXHJcbmludGVyZmFjZSBDbGllbnRSaXNrTWF0cml4UHJvcHMge1xyXG4gIGNsaWVudElkOiBzdHJpbmc7XHJcbiAgb25CYWNrOiAoKSA9PiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDbGllbnRSaXNrTWF0cml4KHsgY2xpZW50SWQsIG9uQmFjayB9OiBDbGllbnRSaXNrTWF0cml4UHJvcHMpIHtcclxuICBjb25zdCBpZCA9IGNsaWVudElkO1xyXG4gIFxyXG4gIGNvbnN0IFtyaXNrTWF0cml4LCBzZXRSaXNrTWF0cml4XSA9IHVzZVN0YXRlPFJpc2tNYXRyaXggfCBudWxsPihudWxsKTtcclxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcclxuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xyXG4gIFxyXG4gIC8vIEZpbHRlciBzdGF0ZVxyXG4gIGNvbnN0IFtzZWFyY2hUZXJtLCBzZXRTZWFyY2hUZXJtXSA9IHVzZVN0YXRlKCcnKTtcclxuICBjb25zdCBbcmlza0xldmVsRmlsdGVyLCBzZXRSaXNrTGV2ZWxGaWx0ZXJdID0gdXNlU3RhdGU8c3RyaW5nPignQWxsJyk7XHJcbiAgY29uc3QgW3N0YXR1c0ZpbHRlciwgc2V0U3RhdHVzRmlsdGVyXSA9IHVzZVN0YXRlPHN0cmluZz4oJ0FsbCcpO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgbG9hZFJpc2tNYXRyaXgoKTtcclxuICB9LCBbaWRdKTtcclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gbG9hZFJpc2tNYXRyaXgoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBzZXRMb2FkaW5nKHRydWUpO1xyXG4gICAgICBzZXRFcnJvcihudWxsKTtcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHdpbmRvdy5hcGkuZ2V0Q2xpZW50Umlza01hdHJpeChpZCEpO1xyXG4gICAgICBzZXRSaXNrTWF0cml4KGRhdGEpO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBsb2FkIHJpc2sgbWF0cml4JztcclxuICAgICAgc2V0RXJyb3IobWVzc2FnZSk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUhhemFyZFVwZGF0ZShoYXphcmRJZDogc3RyaW5nLCB1cGRhdGVzOiBIYXphcmRVcGRhdGUpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHdpbmRvdy5hcGkudXBkYXRlQ2xpZW50SGF6YXJkKGhhemFyZElkLCB1cGRhdGVzKTtcclxuICAgICAgYXdhaXQgbG9hZFJpc2tNYXRyaXgoKTsgLy8gUmVsb2FkIHRvIHNob3cgY2hhbmdlc1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0ZhaWxlZCB0byB1cGRhdGUgaGF6YXJkJztcclxuICAgICAgYWxlcnQoJ0ZhaWxlZCB0byB1cGRhdGUgaGF6YXJkOiAnICsgbWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVBZGRDb250cm9sKGhhemFyZElkOiBzdHJpbmcsIGNvbnRyb2xJZDogc3RyaW5nLCBpc0NyaXRpY2FsOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCB3aW5kb3cuYXBpLmFkZENvbnRyb2xUb0hhemFyZCh7XHJcbiAgICAgICAgY2xpZW50SGF6YXJkSWQ6IGhhemFyZElkLFxyXG4gICAgICAgIGNsaWVudENvbnRyb2xJZDogY29udHJvbElkLFxyXG4gICAgICAgIGlzQ3JpdGljYWxDb250cm9sOiBpc0NyaXRpY2FsXHJcbiAgICAgIH0pO1xyXG4gICAgICBhd2FpdCBsb2FkUmlza01hdHJpeCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBhZGQgY29udHJvbCc7XHJcbiAgICAgIGFsZXJ0KCdGYWlsZWQgdG8gYWRkIGNvbnRyb2w6ICcgKyBtZXNzYWdlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlbW92ZUNvbnRyb2wobWFwcGluZ0lkOiBzdHJpbmcpIHtcclxuICAgIGlmICghY29uZmlybSgnUmVtb3ZlIHRoaXMgY29udHJvbCBmcm9tIHRoZSBoYXphcmQ/JykpIHJldHVybjtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgd2luZG93LmFwaS5yZW1vdmVDb250cm9sRnJvbUhhemFyZChtYXBwaW5nSWQpO1xyXG4gICAgICBhd2FpdCBsb2FkUmlza01hdHJpeCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0ZhaWxlZCB0byByZW1vdmUgY29udHJvbCc7XHJcbiAgICAgIGFsZXJ0KCdGYWlsZWQgdG8gcmVtb3ZlIGNvbnRyb2w6ICcgKyBtZXNzYWdlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEZpbHRlciBoYXphcmRzICh3aXRoIGV4cGxpY2l0IHR5cGUgYW5ub3RhdGlvbilcclxuICBjb25zdCBmaWx0ZXJlZEhhemFyZHMgPSByaXNrTWF0cml4Py5oYXphcmRzLmZpbHRlcigoaGF6YXJkOiBSaXNrTWF0cml4SGF6YXJkKSA9PiB7XHJcbiAgICAvLyBTZWFyY2ggZmlsdGVyXHJcbiAgICBpZiAoc2VhcmNoVGVybSkge1xyXG4gICAgICBjb25zdCB0ZXJtID0gc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgIWhhemFyZC5jb2RlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGVybSkgJiZcclxuICAgICAgICAhaGF6YXJkLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0ZXJtKSAmJlxyXG4gICAgICAgICFoYXphcmQuZGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0ZXJtKVxyXG4gICAgICApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBSaXNrIGxldmVsIGZpbHRlclxyXG4gICAgaWYgKHJpc2tMZXZlbEZpbHRlciAhPT0gJ0FsbCcgJiYgaGF6YXJkLmFkanVzdGVkUmlza0xldmVsICE9PSByaXNrTGV2ZWxGaWx0ZXIpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN0YXR1cyBmaWx0ZXJcclxuICAgIGlmIChzdGF0dXNGaWx0ZXIgPT09ICdDb21wbGV0ZScgJiYgaGF6YXJkLmNvbnRyb2xDb3ZlcmFnZS5wZXJjZW50YWdlIDwgMTAwKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmIChzdGF0dXNGaWx0ZXIgPT09ICdHYXBzJyAmJiBoYXphcmQuY29udHJvbENvdmVyYWdlLnBlcmNlbnRhZ2UgPj0gMTAwKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmIChzdGF0dXNGaWx0ZXIgPT09ICdOL0EnICYmICFoYXphcmQuaXNOb3RBcHBsaWNhYmxlKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9KSB8fCBbXTtcclxuXHJcbiAgaWYgKGxvYWRpbmcpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgaC1zY3JlZW5cIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgICA8UmVmcmVzaEN3IGNsYXNzTmFtZT1cInctOCBoLTggYW5pbWF0ZS1zcGluIG14LWF1dG8gbWItNCB0ZXh0LWJsdWUtNTAwXCIgLz5cclxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS02MDBcIj5Mb2FkaW5nIHJpc2sgbWF0cml4Li4uPC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBpZiAoZXJyb3IgfHwgIXJpc2tNYXRyaXgpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgaC1zY3JlZW5cIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgICA8WENpcmNsZSBjbGFzc05hbWU9XCJ3LTE2IGgtMTYgbXgtYXV0byBtYi00IHRleHQtcmVkLTUwMFwiIC8+XHJcbiAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LXNlbWlib2xkIG1iLTJcIj5FcnJvciBMb2FkaW5nIFJpc2sgTWF0cml4PC9oMj5cclxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS02MDAgbWItNFwiPntlcnJvciB8fCAnUmlzayBtYXRyaXggbm90IGZvdW5kJ308L3A+XHJcbiAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9e29uQmFja31cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwicHgtNCBweS0yIGJnLWJsdWUtNTAwIHRleHQtd2hpdGUgcm91bmRlZCBob3ZlcjpiZy1ibHVlLTYwMFwiXHJcbiAgICAgICAgICA+XHJcbiAgICAgICAgICAgIEJhY2sgdG8gQ2xpZW50c1xyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIm1heC13LTd4bCBteC1hdXRvIHAtNlwiPlxyXG4gICAgICB7LyogSGVhZGVyICovfVxyXG4gICAgICA8Umlza01hdHJpeEhlYWRlclxyXG4gICAgICAgIGNsaWVudD17cmlza01hdHJpeC5jbGllbnR9XHJcbiAgICAgICAgc3VtbWFyeT17cmlza01hdHJpeC5zdW1tYXJ5fVxyXG4gICAgICAgIG9uQmFjaz17b25CYWNrfVxyXG4gICAgICAgIG9uUmVmcmVzaD17bG9hZFJpc2tNYXRyaXh9XHJcbiAgICAgICAgb25FeHBvcnQ9eygpID0+IGFsZXJ0KCdFeHBvcnQgY29taW5nIHNvb24hJyl9XHJcbiAgICAgIC8+XHJcblxyXG4gICAgICB7LyogRmlsdGVycyAqL31cclxuICAgICAgPFJpc2tNYXRyaXhGaWx0ZXJzXHJcbiAgICAgICAgc2VhcmNoVGVybT17c2VhcmNoVGVybX1cclxuICAgICAgICBvblNlYXJjaENoYW5nZT17c2V0U2VhcmNoVGVybX1cclxuICAgICAgICByaXNrTGV2ZWxGaWx0ZXI9e3Jpc2tMZXZlbEZpbHRlcn1cclxuICAgICAgICBvblJpc2tMZXZlbENoYW5nZT17c2V0Umlza0xldmVsRmlsdGVyfVxyXG4gICAgICAgIHN0YXR1c0ZpbHRlcj17c3RhdHVzRmlsdGVyfVxyXG4gICAgICAgIG9uU3RhdHVzQ2hhbmdlPXtzZXRTdGF0dXNGaWx0ZXJ9XHJcbiAgICAgIC8+XHJcblxyXG4gICAgICB7LyogUmVzdWx0cyBjb3VudCAqL31cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi00IHRleHQtc20gdGV4dC1ncmF5LTYwMFwiPlxyXG4gICAgICAgIFNob3dpbmcge2ZpbHRlcmVkSGF6YXJkcy5sZW5ndGh9IG9mIHtyaXNrTWF0cml4LmhhemFyZHMubGVuZ3RofSBoYXphcmRzXHJcbiAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgey8qIFRhYmxlICovfVxyXG4gICAgICA8Umlza01hdHJpeFRhYmxlXHJcbiAgICAgICAgaGF6YXJkcz17ZmlsdGVyZWRIYXphcmRzfVxyXG4gICAgICAgIG9uVXBkYXRlSGF6YXJkPXtoYW5kbGVIYXphcmRVcGRhdGV9XHJcbiAgICAgICAgb25BZGRDb250cm9sPXtoYW5kbGVBZGRDb250cm9sfVxyXG4gICAgICAgIG9uUmVtb3ZlQ29udHJvbD17aGFuZGxlUmVtb3ZlQ29udHJvbH1cclxuICAgICAgICBjbGllbnRJZD17aWQhfVxyXG4gICAgICAvPlxyXG4gICAgPC9kaXY+XHJcbiAgKTtcclxufSJdLCJmaWxlIjoiQzovVXNlcnMvQmlsbC5TL3NhZmV0eS1pbnRlbGxpZ2VuY2UtZW5naW5lL3NyYy9wYWdlcy9DbGllbnRSaXNrTWF0cml4LnRzeCJ9